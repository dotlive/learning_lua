PROJECT(mylib)

SET(SRC_MYLIB mylib.c)
SET_PROPERTY(
	SOURCE ${SRC_MYLIB}
	APPEND
	PROPERTY COMPILE_DEFINITIONS
	LUA_LIB
)

INCLUDE_DIRECTORIES(${CMAKE_HOME_DIRECTORY}/lua-5.2.2/src)
LINK_DIRECTORIES(${CMAKE_HOME_DIRECTORY}/output/lua522/${CMAKE_BUILD_TYPE})

ADD_LIBRARY(mylib SHARED ${SRC_MYLIB})
TARGET_LINK_LIBRARIES(mylib lua5.2)
SET_TARGET_PROPERTIES(mylib PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${COMMON_OUTPUT})

if (WIN32 AND NOT CYGWIN)
    TARGET_COMPILE_DEFINITIONS(mylib PRIVATE LUA_BUILD_AS_DLL)
endif()
